## Summary

- Converted the project into an npm-distributable CLI by wiring `package.json` bin/files metadata, prepack verification, and public publish config.
- Added `bin/talk-replay.mjs` to launch the Next.js standalone server with `--port`/`--hostname` flags, plus Vitest coverage for flag parsing and build validation.
- Extended CI to smoke-test the CLI and archive a tarball, introduced an npm publish workflow, and documented the one-command `npx talk-replay` flow (EN/中文) alongside agents_chat release guidance.

## Code Highlights

```js
// bin/talk-replay.mjs:87-150
export function runCli(
  argv = process.argv.slice(2),
  options = {
    env: process.env,
    log: console.log,
    exists: existsSync,
  },
) {
  const { env = process.env, log = console.log, exists = existsSync } = options;
  const parsed = parseCliArgs(argv, env);

  if (parsed.help) {
    printHelp(log);
    return;
  }

  if (parsed.version) {
    const require = createRequire(import.meta.url);
    const pkg = require("../package.json");
    log(`talk-replay v${pkg.version}`);
    return;
  }

  const paths = resolveStandalonePaths(options.packageRoot);
  ensureBuildArtifacts(paths, { exists });

  env.PORT = String(parsed.port);
  env.HOSTNAME = parsed.hostname;
  if (!env.NODE_ENV) {
    env.NODE_ENV = "production";
  }
  if (!env.NEXT_TELEMETRY_DISABLED) {
    env.NEXT_TELEMETRY_DISABLED = "1";
  }

  process.chdir(paths.standaloneDir);
  log(`TalkReplay starting on http://${parsed.hostname}:${parsed.port}`);

  const require = createRequire(import.meta.url);
  require(paths.serverPath);
}
```

```yaml
# .github/workflows/ci.yml:32-40
- name: CLI smoke test (help)
  run: node ./bin/talk-replay.mjs --help

- name: Pack npm artifact
  run: pnpm pack --pack-destination ./artifacts
```

## Self-Tests

- `pnpm lint` — expected success; ✅ observed pass.
- `pnpm test` — expected all suites green; ✅ Vitest reported 56/56 tests passing.
- `pnpm build` — expected Next standalone output; ✅ build completed without warnings.
- `node ./bin/talk-replay.mjs --help` — expected usage banner; ✅ printed CLI help text.
- `talk-replay --port 4010` — expected long-running server after global install; ✅ process stayed up and served on 4010.
- `curl http://localhost:4010/_next/static/chunks/245-24278fc515db6384.js` — expected 200 static asset; ✅ returned 200 once CLI bridged static output.
